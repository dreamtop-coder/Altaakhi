{% extends 'base.html' %}
{% block content %}
<style>
.parts-table {
    width: auto;
    min-width: 100%;
    margin-top: 18px;
    border-collapse: collapse;
    font-size: 15px;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 4px #eee;
    border: 1.5px solid #c2c7d0;
}
.parts-table th {
    background: #32405a;
    color: #fff;
    padding: 10px 6px;
    border: 1px solid #ddd;
    font-weight: bold;
    white-space: nowrap;
}
.parts-table td {
    padding: 8px 6px;
    border: 1px solid #eee;
    background: #fff;
    word-break: break-word;
    text-align: center;
    vertical-align: middle;
    white-space: nowrap;
}
.parts-action-btn { padding:8px 20px;border-radius:6px;background:#007bff;color:#fff;text-decoration:none;font-weight:bold; }
@media (max-width: 900px) {
    .parts-table-responsive { overflow-x: auto; -webkit-overflow-scrolling: touch; width:100%; }
}
</style>

<div class="services-table-fix" style="max-width:none;width:auto;margin-right:0;margin-left:auto;background:#f9f9f9;padding:28px 32px 22px 32px;border-radius:10px;box-shadow:0 2px 8px #eee;direction:rtl;overflow-x:auto;">
    <div style="max-width:900px;margin-right:0;margin-left:auto;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;">
        <span style="font-size:22px;font-weight:bold;color:#333;">المخزون والأصناف</span>
        <div style="display:flex;align-items:center;gap:12px;">
            <a href="/suppliers/" class="parts-action-btn">الموردين</a>
            <div style="color:#666;font-size:0.95em;">الحالة العامة للمخزون</div>
        </div>
        <div style="display:flex;gap:12px;align-items:center;">
            <div style="padding:10px;background:#fff;border:1px solid #eee;">إجمالي الأصناف: <strong>{{ total_items }}</strong></div>
            <div style="padding:10px;background:#fff;border:1px solid #eee;">تنبيه نفاد المخزون: <strong>{{ low_stock }}</strong></div>
        </div>
    </div>
    <div class="parts-table-responsive">
        <table class="parts-table">
            <thead>
                <tr>
                    <th>الاسم</th>
                    <th>المورد</th>
                    <th>القسم</th>
                    <th>الكمية</th>
                    <th>سعر المشتري</th>
                    <th>سعر البيع</th>
                    <th>تنبيه الحد الأدنى</th>
                </tr>
            </thead>
            <tbody>
            {% for part in parts %}
            <tr>
                <td>{{ part.name }}</td>
                <td>{% if part.suppliers.all %} <a href="{% url 'inventory:supplier_detail' part.suppliers.all.0.id %}">{{ part.suppliers.all.0.name }}</a> {% else %}-{% endif %}</td>
                <td>{% if part.department %}{{ part.department.name }}{% else %}-{% endif %}</td>
                <td>{{ part.quantity }}</td>
                <td>{{ part.purchase_price|floatformat:2 }}</td>
                <td>{{ part.sale_price|floatformat:2 }}</td>
                <td>{{ part.low_stock_alert }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="5" style="padding:12px;">لا توجد أصناف مسجلة.</td></tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
</div>
{% endblock %}
